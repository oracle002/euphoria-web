{"version":3,"file":"connection-B7tAGNEl.js","sources":["../../../.svelte-kit/adapter-node/chunks/connection.js"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\nconst client = new PrismaClient();\nconst connection = {\n  createParticipant,\n  findParticipantByAttribute,\n  addPayment,\n  addParticipation,\n  findSoloEvents,\n  checkTeamNameAvailable,\n  findParticipation,\n  createTeam,\n  getGamingCount,\n  checkEventParticipation\n};\nasync function createParticipant(contestant) {\n  const created = await client.participants.create({\n    data: contestant\n  });\n  return created;\n}\nasync function getGamingCount() {\n  return await client.event_participants.count({\n    where: {\n      event_code: \"RP\"\n    }\n  });\n}\nasync function findParticipantByAttribute(condition) {\n  try {\n    const participant = await client.participants.findUnique({\n      where: condition\n    });\n    return participant;\n  } catch (error) {\n    console.error(\"Error finding participant:\", error);\n    throw error;\n  }\n}\nasync function addPayment(participation) {\n  try {\n    return client.event_payment.create({\n      data: participation\n    });\n  } catch (error) {\n    console.log(\"Error adding payment:\", error);\n    throw error;\n  }\n}\nasync function addParticipation(participation) {\n  try {\n    const saved = await client.event_participants.createMany({\n      data: participation\n    });\n    return saved;\n  } catch (error) {\n    console.log(\"Error adding participation:\", error);\n    throw error;\n  }\n}\nasync function findSoloEvents(userId) {\n  try {\n    const events = await client.event_participants.findMany({\n      where: {\n        participant_id: userId\n      }\n    });\n    return events;\n  } catch (error) {\n    console.log(\"Unable to fetch events \", error);\n  }\n}\nasync function checkTeamNameAvailable(teamName, eventCode) {\n  const team = await client.teams.findMany({\n    where: {\n      team_name: teamName\n    }\n  });\n  return team.length == 0;\n}\nasync function findParticipation(participant_id) {\n  return await client.event_participants.findMany({\n    where: {\n      participant_id\n    }\n  });\n}\nasync function createTeam(payment, participation, team) {\n  return client.$transaction([\n    client.event_payment.create({\n      data: {\n        ...payment,\n        participation: {\n          create: [participation]\n        }\n      }\n    }),\n    client.teams.create({\n      data: team\n    })\n  ]);\n}\nasync function checkEventParticipation(email, eventCode) {\n  return await client.participants.findMany({\n    where: {\n      email: {\n        in: email\n      },\n      event_participant: {\n        some: {\n          event_code: eventCode\n        }\n      }\n    }\n  });\n}\nexport {\n  client as a,\n  connection as c\n};\n"],"names":[],"mappings":"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"}